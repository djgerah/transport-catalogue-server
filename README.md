# Transport Catalogue Server

HTTP-—Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–º —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º.
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—Å—Ç–∞–Ω–æ–≤–∫–∞—Ö –∏ –º–∞—Ä—à—Ä—É—Ç–∞—Ö, –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∫–∞—Ä—Ç—ã –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —á–∞—Å—Ç–µ–π:

* **Transport Catalogue** ‚Äî —è–¥—Ä–æ, –∫–æ—Ç–æ—Ä–æ–µ —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—Å—Ç–∞–Ω–æ–≤–∫–∞—Ö, –∞–≤—Ç–æ–±—É—Å–∞—Ö, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è—Ö, —Å—Ç—Ä–æ–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –º–∞—Ä—à—Ä—É—Ç–æ–≤.
* **HTTP Server** ‚Äî –æ–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–º —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–∏–º —á–µ—Ä–µ–∑ REST API.

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* **Transport Catalogue**

  * —Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏;
  * —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–±—É—Å–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤;
  * –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫, –¥–ª–∏–Ω–∞, –∫—Ä–∏–≤–∏–∑–Ω–∞);
  * —É—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –º–µ–∂–¥—É –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏.

* **HTTP API**

  * `POST /load` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (`base_requests`, `render_settings`, `routing_settings`);
  * `POST /query` ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ `stat_requests` (Bus, Stop, Map, Route);
  * `GET /map` ‚Äî —Ä–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ SVG;
  * `PUT /stop` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏;
  * `PUT /bus` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞ –∞–≤—Ç–æ–±—É—Å–∞;
  * `PATCH /patch` ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ –≤ –º–∞—Ä—à—Ä—É—Ç).

---

## –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

```http
PUT /stop
Content-Type: application/json

{
  "base_requests": [
    {
      "type": "Stop",
      "name": "–°–ù–¢ –õ–µ—Å–Ω–æ–π –£–≥–æ–ª–æ–∫",
      "latitude": 55.667273,
      "longitude": 38.103734,
      "road_distances": {
        "–ü–æ–≤–æ—Ä–æ—Ç –Ω–∞ –ü–æ–ª—É—à–∫–∏–Ω–æ": 2500,
        "–ü–æ–≤–æ—Ä–æ—Ç –Ω–∞ –ó—é–∑–∏–Ω–æ": 500
      }
    }
  ]
}
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞

```http
PUT /bus
Content-Type: application/json

{
  "base_requests": [
    {
      "type": "Bus",
      "name": "38",
      "stops": [
        "–û—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Ññ1",
        "–û—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Ññ2",
        "–û—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Ññ3"
      ],
      "is_roundtrip": false
    }
  ]
}
```

### –ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞

```http
PATCH /patch
Content-Type: application/json

{
  "base_requests": [
    {
      "type": "Bus",
      "name": "37",
      "stops": [
        "–°–ù–¢ –õ–µ—Å–Ω–æ–π –£–≥–æ–ª–æ–∫"
      ],
      "position": 3,
      "is_roundtrip": false
    }
  ]
}
```

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–∞—Ä—à—Ä—É—Ç—É)

```http
POST /query
Content-Type: application/json

{
  "stat_requests": [
    {
      "id": 1,
      "name": "37",
      "type": "Bus"
    }
  ]
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã

```http
GET /map
```

–û—Ç–≤–µ—Ç: SVG-–¥–æ–∫—É–º–µ–Ω—Ç.
–ü—Ä–∏–º–µ—Ä –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤:

![–ü—Ä–∏–º–µ—Ä –∫–∞—Ä—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤](data/map_example.png)

---

## –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
make run
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ [http://localhost:8080](http://localhost:8080).

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

* C++17
* [cpp-httplib](https://github.com/yhirose/cpp-httplib) ‚Äî HTTP —Å–µ—Ä–≤–µ—Ä
* –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π JSON-–ø–∞—Ä—Å–µ—Ä
* SVG-—Ä–µ–Ω–¥–µ—Ä –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã

---

üöÄ `transport-catalogue` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ –∫–∞–∫ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ REST API.